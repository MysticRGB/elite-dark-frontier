<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Elite: Dark Frontier</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&family=Orbitron:wght@400;700;900&display=swap');
:root{
  --c1:#f0a030;--c1b:#ffd070;--c1d:#8a5a10;--c1g:rgba(240,160,48,.15);
  --bg:#06050e;--bg2:#0a0914;
  --glass:rgba(12,10,22,.82);--glass-b:rgba(240,160,48,.04);--glass-border:rgba(240,160,48,.12);
  --text:#e0d0b0;--text-d:#8a7a5a;--text-dd:#5a4a2a;
  --grn:#40ff80;--red:#ff5050;--blu:#40a0ff;--cyn:#00e8ff;
  --radius:8px;
  --font:'Inter',system-ui,sans-serif;
  --mono:'JetBrains Mono',monospace;
  --title:'Orbitron',sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box}
html{font-size:16px;-webkit-text-size-adjust:100%}
body{background:var(--bg);font-family:var(--font);color:var(--text);overflow:hidden;height:100vh;height:100dvh;display:flex;flex-direction:column}
::selection{background:rgba(240,160,48,.3);color:#fff}
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--c1d);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--c1)}

/* ‚ïê‚ïê‚ïê ANIMATED BACKGROUND ‚ïê‚ïê‚ïê */
#bg-canvas{position:fixed;inset:0;z-index:0;pointer-events:none}
#bg-grad{position:fixed;inset:0;z-index:1;pointer-events:none;
  background:radial-gradient(ellipse at 50% 30%,rgba(30,18,4,.25) 0%,transparent 60%)}

/* ‚ïê‚ïê‚ïê TOP NAV ‚ïê‚ïê‚ïê */
#nav{position:relative;z-index:100;height:52px;min-height:52px;
  display:flex;align-items:center;gap:4px;padding:0 16px;
  background:var(--glass);border-bottom:1px solid var(--glass-border);
  backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px)}
.nav-logo{font-family:var(--title);font-weight:900;font-size:13px;
  color:var(--c1b);letter-spacing:4px;cursor:pointer;white-space:nowrap;
  text-shadow:0 0 20px rgba(240,160,48,.4);transition:text-shadow .3s;margin-right:8px}
.nav-logo:hover{text-shadow:0 0 30px rgba(240,160,48,.7)}
.nav-logo span{font-weight:400;font-size:10px;color:var(--c1d);letter-spacing:1px;margin-left:6px}
.n-btn{background:none;border:1px solid transparent;color:var(--text-d);
  padding:6px 14px;cursor:pointer;font-family:var(--font);font-size:13px;font-weight:500;
  border-radius:20px;transition:all .2s;white-space:nowrap;letter-spacing:.5px}
.n-btn:hover{color:var(--c1b);background:var(--c1g);border-color:var(--glass-border)}
.n-btn.act{color:var(--c1b);background:var(--c1g);border-color:rgba(240,160,48,.25);
  box-shadow:0 0 12px rgba(240,160,48,.1)}
.nav-spacer{flex:1}
.nav-hud{display:flex;align-items:center;gap:14px;padding-left:12px;
  border-left:1px solid var(--glass-border)}
.hud-chip{display:flex;align-items:center;gap:5px;font-family:var(--mono);font-size:12px}
.hud-chip .lbl{color:var(--text-dd);font-size:10px;text-transform:uppercase;letter-spacing:1px}
.hud-chip .val{color:var(--c1b);font-weight:700}
#nav-scroll{display:flex;gap:3px;overflow-x:auto;scrollbar-width:none;flex:1;align-items:center}
#nav-scroll::-webkit-scrollbar{display:none}

/* ‚ïê‚ïê‚ïê MAIN CONTENT ‚ïê‚ïê‚ïê */
#main{flex:1;position:relative;z-index:10;overflow:hidden}
#welcome{position:absolute;inset:0;overflow-y:auto;padding:24px 20px 40px;
  scrollbar-width:thin;scrollbar-color:var(--c1d) transparent;
  transition:opacity .4s,transform .4s}
#welcome.out{opacity:0;transform:scale(.98);pointer-events:none}
#frame{position:absolute;inset:0;border:none;background:var(--bg);
  transition:opacity .3s;width:100%;height:100%}
#frame.hide{opacity:0;pointer-events:none}

/* ‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê */
.hero{text-align:center;max-width:820px;margin:0 auto 28px;padding-top:8px}
.hero-title{font-family:var(--title);font-weight:900;font-size:clamp(22px,4vw,36px);
  background:linear-gradient(135deg,var(--c1) 0%,var(--c1b) 50%,#fff 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  line-height:1.2;margin-bottom:10px;
  animation:hero-shimmer 4s ease-in-out infinite alternate}
@keyframes hero-shimmer{
  0%{filter:brightness(1) drop-shadow(0 0 12px rgba(240,160,48,.3))}
  100%{filter:brightness(1.15) drop-shadow(0 0 20px rgba(240,160,48,.5))}}
.hero-sub{font-size:clamp(13px,2vw,16px);color:var(--text-d);line-height:1.7;max-width:640px;margin:0 auto}
.hero-sub b{color:var(--c1b);font-weight:600}

/* ‚ïê‚ïê‚ïê NASA ‚ïê‚ïê‚ïê */
.nasa-row{display:flex;gap:12px;max-width:920px;margin:0 auto 20px;flex-wrap:wrap}
.nasa-card{flex:1;min-width:280px;background:var(--glass);border:1px solid var(--glass-border);
  border-radius:var(--radius);overflow:hidden;backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);transition:border-color .3s}
.nasa-card:hover{border-color:rgba(240,160,48,.25)}
.nasa-card img{width:100%;height:180px;object-fit:cover;display:block;border-bottom:1px solid var(--glass-border)}
.nasa-card iframe{width:100%;height:180px;border:none;border-bottom:1px solid var(--glass-border)}
.nasa-body{padding:12px 14px}
.nasa-tag{font-family:var(--mono);font-size:10px;color:var(--c1);letter-spacing:2px;
  text-transform:uppercase;margin-bottom:4px}
.nasa-title{font-family:var(--title);font-size:12px;color:var(--c1b);margin-bottom:6px;letter-spacing:1px}
.nasa-desc{font-size:13px;color:var(--text-d);line-height:1.5}
.neo-list{display:flex;flex-wrap:wrap;gap:6px;padding:12px 14px}
.neo-chip{background:rgba(240,160,48,.05);border:1px solid var(--glass-border);
  border-radius:6px;padding:6px 10px;font-size:12px;font-family:var(--mono)}
.neo-chip .name{color:var(--c1b);font-weight:700}
.neo-chip .info{color:var(--text-dd);font-size:11px}
.neo-chip .danger{color:var(--red);font-weight:700}

/* ‚ïê‚ïê‚ïê MODULE GRID ‚ïê‚ïê‚ïê */
.grid-title{text-align:center;font-family:var(--title);font-size:11px;color:var(--text-dd);
  letter-spacing:4px;text-transform:uppercase;margin-bottom:14px}
.mod-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));
  gap:10px;max-width:920px;margin:0 auto 20px}
.mod-card{background:var(--glass);border:1px solid var(--glass-border);border-radius:var(--radius);
  padding:16px;cursor:pointer;transition:all .25s;position:relative;overflow:hidden;
  backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}
.mod-card::after{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;border-radius:3px 0 0 3px;
  background:var(--c1);opacity:.3;transition:opacity .25s}
.mod-card:hover{border-color:rgba(240,160,48,.3);transform:translateY(-2px);
  box-shadow:0 8px 24px rgba(0,0,0,.3),0 0 1px rgba(240,160,48,.3)}
.mod-card:hover::after{opacity:1}
.mod-card:active{transform:translateY(0)}
.mod-card .ic{font-size:28px;margin-bottom:8px;filter:drop-shadow(0 2px 6px rgba(240,160,48,.2))}
.mod-card .nm{font-family:var(--title);font-size:10px;color:var(--c1b);letter-spacing:2px;margin-bottom:4px}
.mod-card .ds{font-size:13px;color:var(--text-d);line-height:1.4}

/* ‚ïê‚ïê‚ïê NEWS TICKER ‚ïê‚ïê‚ïê */
.ticker{max-width:920px;margin:0 auto;height:32px;display:flex;align-items:center;
  background:var(--glass);border:1px solid var(--glass-border);border-radius:var(--radius);
  overflow:hidden;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}
.ticker-tag{background:linear-gradient(135deg,var(--c1),#cc7700);color:#000;
  font-family:var(--mono);font-size:9px;font-weight:700;padding:4px 10px;
  letter-spacing:2px;flex-shrink:0;border-radius:var(--radius) 0 0 var(--radius)}
.ticker-scroll{flex:1;overflow:hidden;position:relative;height:100%}
.ticker-text{white-space:nowrap;color:var(--text-d);font-size:13px;
  position:absolute;top:50%;transform:translateY(-50%);will-change:transform}

/* ‚ïê‚ïê‚ïê PROFILE ‚ïê‚ïê‚ïê */
#profile{position:fixed;top:52px;right:-400px;width:390px;height:calc(100vh - 52px);height:calc(100dvh - 52px);
  background:var(--glass);border-left:1px solid var(--glass-border);
  backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
  z-index:90;padding:20px;overflow-y:auto;
  transition:right .4s cubic-bezier(.4,0,.2,1);
  scrollbar-width:thin;scrollbar-color:var(--c1d) transparent}
#profile.open{right:0}
.p-close{position:absolute;top:10px;right:10px;background:none;border:none;
  color:var(--text-dd);font-size:22px;cursor:pointer;transition:color .2s;
  width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:50%}
.p-close:hover{color:var(--c1);background:var(--c1g)}
.p-title{font-family:var(--title);font-size:13px;color:var(--c1b);letter-spacing:3px;
  text-align:center;margin-bottom:16px;padding-bottom:10px;border-bottom:1px solid var(--glass-border)}
.p-row{display:flex;justify-content:space-between;padding:5px 0;border-bottom:1px solid rgba(240,160,48,.04)}
.p-row .lbl{color:var(--text-dd);font-size:13px} .p-row .val{color:var(--c1b);font-weight:600;font-family:var(--mono);font-size:13px}
.p-section{margin-top:14px;background:rgba(240,160,48,.02);border:1px solid var(--glass-border);
  border-radius:var(--radius);padding:12px}
.p-section-t{font-family:var(--title);font-size:10px;color:var(--c1);letter-spacing:2px;
  margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid var(--glass-border)}
.p-bar{height:6px;background:rgba(240,160,48,.08);border-radius:3px;overflow:hidden;margin:4px 0}
.p-bar-fill{height:100%;background:linear-gradient(90deg,var(--c1d),var(--c1),var(--c1b));
  border-radius:3px;transition:width .5s ease;box-shadow:0 0 8px rgba(240,160,48,.2)}
.skill-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.skill-card{background:rgba(240,160,48,.03);border:1px solid var(--glass-border);
  border-radius:6px;padding:8px;text-align:center;transition:border-color .2s}
.skill-card.on{border-color:rgba(240,160,48,.25)}
.skill-card .ic{font-size:18px} .skill-card .nm{font-size:11px;color:var(--text-dd);margin:2px 0}
.skill-card .lv{font-family:var(--mono);font-size:16px;color:var(--c1b);font-weight:700}
.lvl-badge{display:inline-block;padding:2px 8px;border:1px solid var(--c1);
  border-radius:10px;font-family:var(--mono);font-size:10px;color:var(--c1b);margin-left:4px;
  background:var(--c1g)}

/* ‚ïê‚ïê‚ïê STATUS BAR ‚ïê‚ïê‚ïê */
#status{height:28px;min-height:28px;display:flex;align-items:center;padding:0 16px;gap:16px;
  background:var(--glass);border-top:1px solid var(--glass-border);
  backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);z-index:100;
  font-size:12px;color:var(--text-dd)}
#status-msg{flex:1;transition:color .3s}
#status-loc{font-family:var(--mono);color:var(--c1d);font-size:11px}
@keyframes s-flash{0%{color:var(--grn);text-shadow:0 0 8px var(--grn)}100%{color:var(--text-dd);text-shadow:none}}
#status-msg.flash{animation:s-flash .8s ease}

/* ‚ïê‚ïê‚ïê TOAST ‚ïê‚ïê‚ïê */
#toast{position:fixed;bottom:40px;left:50%;transform:translateX(-50%) translateY(20px);z-index:200;
  background:var(--glass);border:1px solid var(--glass-border);border-radius:var(--radius);
  padding:10px 20px;font-size:13px;color:var(--c1b);backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);opacity:0;pointer-events:none;transition:all .3s;white-space:nowrap}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* ‚ïê‚ïê‚ïê ANIMATIONS ‚ïê‚ïê‚ïê */
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.mod-card{animation:fadeUp .5s cubic-bezier(.4,0,.2,1) both}
.mod-card:nth-child(1){animation-delay:.02s}.mod-card:nth-child(2){animation-delay:.05s}
.mod-card:nth-child(3){animation-delay:.08s}.mod-card:nth-child(4){animation-delay:.11s}
.mod-card:nth-child(5){animation-delay:.14s}.mod-card:nth-child(6){animation-delay:.17s}
.mod-card:nth-child(7){animation-delay:.2s}.mod-card:nth-child(8){animation-delay:.23s}
.mod-card:nth-child(9){animation-delay:.26s}.mod-card:nth-child(10){animation-delay:.29s}

/* ‚ïê‚ïê‚ïê RESPONSIVE ‚ïê‚ïê‚ïê */
@media(max-width:768px){
  #nav{height:46px;min-height:46px;padding:0 8px;gap:2px}
  .nav-logo{font-size:10px;letter-spacing:2px;margin-right:4px}
  .nav-logo span{display:none}
  .n-btn{padding:5px 10px;font-size:12px}
  .nav-hud{gap:8px;padding-left:6px}
  .hud-chip .val{font-size:11px}
  .hud-chip .lbl{font-size:9px}
  #welcome{padding:12px 10px 30px}
  .hero-sub{font-size:13px;line-height:1.5}
  .nasa-row{flex-direction:column}
  .mod-grid{grid-template-columns:repeat(2,1fr);gap:8px}
  .mod-card{padding:12px}
  .mod-card .ic{font-size:22px;margin-bottom:4px}
  .mod-card .nm{font-size:8px}
  .mod-card .ds{font-size:12px}
  #profile{width:100%;right:-100%}
  #status{height:24px;min-height:24px;font-size:11px}
  .ticker{height:28px}
}
@media(max-width:480px){
  .mod-grid{grid-template-columns:1fr 1fr;gap:6px}
  .n-btn{padding:4px 8px;font-size:11px}
  .nav-hud .hud-chip:last-child{display:none}
}
@supports(padding:env(safe-area-inset-top)){
  #nav{padding-top:env(safe-area-inset-top)}
  #status{padding-bottom:env(safe-area-inset-bottom)}
}
</style>
</head>
<body>

<canvas id="bg-canvas"></canvas>
<div id="bg-grad"></div>

<nav id="nav">
  <div class="nav-logo" id="logo">ELITE<span>DARK FRONTIER</span></div>
  <div id="nav-scroll">
    <button class="n-btn act" data-m="welcome">–ì–ª–∞–≤–Ω–∞—è</button>
    <button class="n-btn" data-m="modules/starmap.html">–ö–∞—Ä—Ç–∞ –Ω–µ–±–∞</button>
    <button class="n-btn" data-m="modules/constructors.html">–í–µ—Ä—Ñ—å</button>
    <button class="n-btn" data-m="modules/mining.html">–î–æ–±—ã—á–∞</button>
    <button class="n-btn" data-m="modules/asteroid.html">–ê—Å—Ç–µ—Ä–æ–∏–¥</button>
    <button class="n-btn" data-m="modules/planetarium.html">–ü–ª–∞–Ω–µ—Ç–∞—Ä–∏–π</button>
    <button class="n-btn" data-m="modules/rover.html">–†–æ–≤–µ—Ä</button>
    <button class="n-btn" data-m="modules/terraforming.html">–°–∫–∞–Ω–µ—Ä</button>
    <button class="n-btn" data-m="modules/market.html">–†—ã–Ω–æ–∫</button>
    <button class="n-btn" data-m="modules/changelog.html">–ñ—É—Ä–Ω–∞–ª</button>
  </div>
  <div class="nav-hud">
    <div class="hud-chip"><span class="lbl">CR</span><span class="val" id="h-cr">50 000</span></div>
    <div class="hud-chip"><span class="lbl">–¢–æ–ø–ª–∏–≤–æ</span><span class="val" id="h-fuel">7.0</span></div>
    <div class="hud-chip"><span class="lbl">–ì—Ä—É–∑</span><span class="val" id="h-cargo">0/20</span></div>
    <button class="n-btn" id="btn-pilot">–ü–∏–ª–æ—Ç</button>
  </div>
</nav>

<div id="main">
  <div id="welcome">
    <section class="hero">
      <h1 class="hero-title">ELITE: DARK FRONTIER</h1>
      <p class="hero-sub">
        <b>2847 –≥–æ–¥.</b> –¢—ë–º–Ω—ã–π –§—Ä–æ–Ω—Ç–∏—Ä ‚Äî —Ä—É–±–µ–∂ –æ—Å–≤–æ–µ–Ω–Ω–æ–≥–æ –∫–æ—Å–º–æ—Å–∞.<br>
        –í–æ –í—Å–µ–ª–µ–Ω–Ω–æ–π <b>‚âà2 —Ç—Ä–ª–Ω –≥–∞–ª–∞–∫—Ç–∏–∫</b> –∏ <b>200 –º–ª—Ä–¥ —Ç—Ä–ª–Ω –∑–≤—ë–∑–¥</b>.<br>
        –í –ú–ª–µ—á–Ω–æ–º –ü—É—Ç–∏ ‚Äî <b>400 –º–ª—Ä–¥ –∑–≤—ë–∑–¥</b> –∏ <b>~1 —Ç—Ä–ª–Ω –ø–ª–∞–Ω–µ—Ç</b>.<br>
        –ö–∞–∂–¥–∞—è –∑–≤–µ–∑–¥–∞ –∑–¥–µ—Å—å ‚Äî —Ä–µ–∞–ª—å–Ω–∞—è –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ <b>Hipparcos</b>.
      </p>
    </section>

    <div class="nasa-row">
      <div class="nasa-card" id="apod-card" style="display:none">
        <img id="apod-img" src="" alt="NASA APOD">
        <div class="nasa-body">
          <div class="nasa-tag">NASA &bull; –§–æ—Ç–æ –¥–Ω—è</div>
          <div class="nasa-title" id="apod-title"></div>
          <div class="nasa-desc" id="apod-desc"></div>
        </div>
      </div>
      <div class="nasa-card" id="neo-card" style="display:none">
        <div class="nasa-body">
          <div class="nasa-tag">NASA NEO &bull; –û–∫–æ–ª–æ–∑–µ–º–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã</div>
        </div>
        <div class="neo-list" id="neo-list"></div>
      </div>
    </div>

    <div class="grid-title">‚Äî –ú–û–î–£–õ–ò ‚Äî</div>
    <div class="mod-grid">
      <div class="mod-card" data-m="modules/starmap.html">
        <div class="ic">üåå</div><div class="nm">–ö–ê–†–¢–ê –ù–ï–ë–ê</div>
        <div class="ds">5000+ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–≤—ë–∑–¥, —Ç–æ—Ä–≥–æ–≤–ª—è, –º–∞—Ä—à—Ä—É—Ç—ã, –°–æ–ª–Ω–µ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</div>
      </div>
      <div class="mod-card" data-m="modules/constructors.html">
        <div class="ic">üöÄ</div><div class="nm">–í–ï–†–§–¨</div>
        <div class="ds">14 –∫–æ—Ä–∞–±–ª–µ–π, 7 —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤, 14 —Å—Ç–∞–Ω—Ü–∏–π ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</div>
      </div>
      <div class="mod-card" data-m="modules/mining.html">
        <div class="ic">‚õèÔ∏è</div><div class="nm">–î–û–ë–´–ß–ê</div>
        <div class="ds">–ü–æ–ª—ë—Ç, –ª–∞–∑–µ—Ä–Ω–∞—è —Å—Ç—Ä–µ–ª—å–±–∞ –ø–æ –∞—Å—Ç–µ—Ä–æ–∏–¥–∞–º, —Å–±–æ—Ä —Ä–µ—Å—É—Ä—Å–æ–≤</div>
      </div>
      <div class="mod-card" data-m="modules/asteroid.html">
        <div class="ic">ü™®</div><div class="nm">–ê–°–¢–ï–†–û–ò–î</div>
        <div class="ds">7 —Å—Ç–∞–¥–∏–π —Å–∫—É–ª—å–ø—Ç–∏–Ω–≥–∞, 10 –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤</div>
      </div>
      <div class="mod-card" data-m="modules/planetarium.html">
        <div class="ic">ü™ê</div><div class="nm">–ü–õ–ê–ù–ï–¢–ê–†–ò–ô</div>
        <div class="ds">Perlin-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, 84 —Ä–µ—Å—É—Ä—Å–∞, –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã –∏ –∫–æ–ª—å—Ü–∞</div>
      </div>
      <div class="mod-card" data-m="modules/rover.html">
        <div class="ic">ü§ñ</div><div class="nm">–†–û–í–ï–†</div>
        <div class="ds">6-–∫–æ–ª—ë—Å–Ω—ã–π —Ä–æ–≤–µ—Ä –Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–æ–π –ø–ª–∞–Ω–µ—Ç–µ, —Ä–∞–∑–≤–µ–¥–∫–∞</div>
      </div>
      <div class="mod-card" data-m="modules/terraforming.html">
        <div class="ic">üõ∞Ô∏è</div><div class="nm">–°–ö–ê–ù–ï–†</div>
        <div class="ds">–°–ø—É—Ç–Ω–∏–∫–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, 8 –±–∏–æ–º–æ–≤, WebGL —à–µ–π–¥–µ—Ä—ã</div>
      </div>
      <div class="mod-card" data-m="modules/market.html">
        <div class="ic">üìà</div><div class="nm">–†–´–ù–û–ö</div>
        <div class="ds">5 —Å–µ–∫—Ç–æ—Ä–æ–≤, CoinGecko API, —Å–ø–∞—Ä–∫–ª–∞–π–Ω—ã, –∞–∫—Ü–∏–∏</div>
      </div>
      <div class="mod-card" data-m="modules/changelog.html">
        <div class="ic">üìã</div><div class="nm">–ñ–£–†–ù–ê–õ</div>
        <div class="ds">–ë–æ—Ä—Ç–æ–≤–æ–π –∂—É—Ä–Ω–∞–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –ø–∞—Ç—á–∏</div>
      </div>
      <div class="mod-card" id="card-pilot">
        <div class="ic">üë®‚ÄçüöÄ</div><div class="nm">–ö–ê–ë–ò–ù–ï–¢ –ü–ò–õ–û–¢–ê</div>
        <div class="ds">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –Ω–∞–≤—ã–∫–∏, —Ä–µ–ø—É—Ç–∞—Ü–∏—è, –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
      </div>
    </div>

    <div class="ticker">
      <div class="ticker-tag">–ù–û–í–û–°–¢–ò</div>
      <div class="ticker-scroll"><div class="ticker-text" id="ticker"></div></div>
    </div>
  </div>

  <iframe id="frame" class="hide" src="about:blank"></iframe>
</div>

<aside id="profile">
  <button class="p-close" id="p-close">&times;</button>
  <div class="p-title">–ö–ê–ë–ò–ù–ï–¢ –ö–û–ú–ê–ù–î–û–†–ê</div>
  <div id="p-body"></div>
</aside>

<footer id="status">
  <span id="status-msg">–°–∏—Å—Ç–µ–º—ã –∞–∫—Ç–∏–≤–Ω—ã. –ì–æ—Ç–æ–≤ –∫ –≤—ã–ª–µ—Ç—É.</span>
  <span id="status-loc">–°–µ–∫—Ç–æ—Ä: Sol</span>
</footer>

<div id="toast"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  STAR FIELD (Canvas 2D)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
(function initStars(){
  const cv=document.getElementById('bg-canvas'),ctx=cv.getContext('2d');
  let W,H;
  function resize(){W=cv.width=innerWidth;H=cv.height=innerHeight;}
  resize(); addEventListener('resize',resize);
  const N=180;
  const stars=Array.from({length:N},()=>({
    x:Math.random()*2000,y:Math.random()*2000,
    r:Math.random()*1.4+.3,a:Math.random(),da:(Math.random()-.5)*.015
  }));
  function draw(){
    ctx.clearRect(0,0,W,H);
    for(const s of stars){
      s.a+=s.da;
      if(s.a>1||s.a<.05)s.da=-s.da;
      const sx=s.x%W,sy=s.y%H;
      ctx.globalAlpha=s.a;
      ctx.fillStyle='#ffd8a0';
      ctx.beginPath();ctx.arc(sx,sy,s.r,0,6.28);ctx.fill();
    }
    ctx.globalAlpha=1;
    requestAnimationFrame(draw);
  }
  draw();
})();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  GAME STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DEF={
  pilot:{name:'–ö–æ–º–∞–Ω–¥–æ—Ä',rank:'–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü',faction:'–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ'},
  credits:50000,fuel:7,maxFuel:7,cargo:[],maxCargo:20,
  ships:[{name:'–ö–û–ë–†–ê MK-I',level:1}],currentShip:0,
  location:{system:'Sol',body:null},
  stats:{jumps:0,trades:0,mined:0,sculpted:0,planetsScanned:0,roversDeployed:0,stockTrades:0,totalProfit:0,distanceLY:0},
  achievements:[],portfolio:{},
  reputation:{traders:0,miners:0,explorers:0,military:0},savedAt:null
};
function loadGS(){
  try{const r=localStorage.getItem('elite_df_state');
    if(r){const s=JSON.parse(r);return{...DEF,...s,stats:{...DEF.stats,...s.stats},reputation:{...DEF.reputation,...s.reputation}};}
  }catch(e){}
  return{...DEF};
}
function saveGS(){gs.savedAt=Date.now();localStorage.setItem('elite_df_state',JSON.stringify(gs));}
let gs=loadGS();
setInterval(saveGS,30000);

function updateHUD(){
  document.getElementById('h-cr').textContent=gs.credits.toLocaleString('ru-RU');
  document.getElementById('h-fuel').textContent=gs.fuel.toFixed(1);
  document.getElementById('h-cargo').textContent=gs.cargo.length+'/'+gs.maxCargo;
}
updateHUD();

function flashEl(id){
  const el=document.getElementById(id);if(!el)return;
  el.classList.remove('flash');void el.offsetWidth;el.classList.add('flash');
  setTimeout(()=>el.classList.remove('flash'),800);
}
function toast(msg){
  const t=document.getElementById('toast');t.textContent=msg;
  t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3000);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  NAVIGATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const frame=document.getElementById('frame');
const welcome=document.getElementById('welcome');
let curMod='welcome';

function goTo(mod){
  document.querySelectorAll('.n-btn[data-m]').forEach(b=>b.classList.toggle('act',b.dataset.m===mod));
  if(mod==='welcome'){
    welcome.classList.remove('out');
    frame.classList.add('hide');frame.src='about:blank';
    curMod='welcome';
    document.getElementById('status-msg').textContent='–°–∏—Å—Ç–µ–º—ã –∞–∫—Ç–∏–≤–Ω—ã. –ì–æ—Ç–æ–≤ –∫ –≤—ã–ª–µ—Ç—É.';
    return;
  }
  welcome.classList.add('out');
  frame.classList.remove('hide');
  frame.src=mod;curMod=mod;
  const names={'modules/starmap.html':'–ö–∞—Ä—Ç–∞ –Ω–µ–±–∞','modules/constructors.html':'–í–µ—Ä—Ñ—å',
    'modules/mining.html':'–î–æ–±—ã—á–∞','modules/asteroid.html':'–ê—Å—Ç–µ—Ä–æ–∏–¥',
    'modules/planetarium.html':'–ü–ª–∞–Ω–µ—Ç–∞—Ä–∏–π','modules/rover.html':'–†–æ–≤–µ—Ä',
    'modules/terraforming.html':'–°–∫–∞–Ω–µ—Ä','modules/market.html':'–†—ã–Ω–æ–∫',
    'modules/changelog.html':'–ñ—É—Ä–Ω–∞–ª'};
  document.getElementById('status-msg').textContent='–ú–æ–¥—É–ª—å: '+(names[mod]||mod);
}

document.querySelectorAll('[data-m]').forEach(el=>{
  el.addEventListener('click',()=>goTo(el.dataset.m));
});
document.getElementById('logo').addEventListener('click',()=>goTo('welcome'));

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  PROFILE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const prof=document.getElementById('profile');
document.getElementById('btn-pilot').addEventListener('click',()=>{prof.classList.toggle('open');if(prof.classList.contains('open'))renderProfile();});
document.getElementById('p-close').addEventListener('click',()=>prof.classList.remove('open'));
document.getElementById('card-pilot').addEventListener('click',()=>{prof.classList.add('open');renderProfile();});

function calcSkills(s){
  const sk={
    navigation:{nm:'–ù–∞–≤–∏–≥–∞—Ü–∏—è',ic:'üß≠',xp:s.stats.jumps*10+s.stats.distanceLY*2},
    trade:{nm:'–¢–æ—Ä–≥–æ–≤–ª—è',ic:'üí∞',xp:s.stats.trades*15+s.stats.stockTrades*10},
    mining:{nm:'–î–æ–±—ã—á–∞',ic:'‚õèÔ∏è',xp:s.stats.mined*12+(s.stats.sculpted||0)*5},
    exploration:{nm:'–†–∞–∑–≤–µ–¥–∫–∞',ic:'üî≠',xp:s.stats.planetsScanned*20+s.stats.roversDeployed*15},
    engineering:{nm:'–ò–Ω–∂–µ–Ω–µ—Ä–∏—è',ic:'üîß',xp:Math.floor(s.credits/1000)+s.cargo.length*5},
    combat:{nm:'–ë–æ–µ–≤—ã–µ',ic:'‚öîÔ∏è',xp:s.stats.mined*3+s.stats.jumps*2},
  };
  Object.values(sk).forEach(s=>{
    s.level=Math.min(50,Math.floor(Math.sqrt(s.xp/10)));
    s.next=Math.pow(s.level+1,2)*10;
    s.pct=s.next>0?Math.min(100,s.xp/s.next*100):100;
  });
  return sk;
}

function renderProfile(){
  const s=gs,cw=s.cargo.reduce((a,c)=>a+(c.qty||1),0);
  const ranks=['–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü','–ü–∏–ª–æ—Ç','–ù–∞–≤–∏–≥–∞—Ç–æ—Ä','–ö–∞–ø–∏—Ç–∞–Ω','–ö–æ–º–º–∞–Ω–¥–µ—Ä','–ê–¥–º–∏—Ä–∞–ª','–≠–ª–∏—Ç–∞'];
  const sk=calcSkills(s);
  const tl=Object.values(sk).reduce((a,s)=>a+s.level,0);
  const ri=Math.min(ranks.length-1,Math.floor(tl/10));
  s.pilot.rank=ranks[ri];
  const xp=Object.values(sk).reduce((a,s)=>a+s.xp,0);
  const nxp=(ri+1)*600;
  const pct=Math.min(100,xp/nxp*100);

  document.getElementById('p-body').innerHTML=`
    <div class="p-row"><span class="lbl">–ò–º—è</span><span class="val">${s.pilot.name}</span></div>
    <div class="p-row"><span class="lbl">–†–∞–Ω–≥</span><span class="val">${s.pilot.rank} <span class="lvl-badge">LV ${tl}</span></span></div>
    <div class="p-row"><span class="lbl">–§—Ä–∞–∫—Ü–∏—è</span><span class="val">${s.pilot.faction}</span></div>
    <div class="p-bar"><div class="p-bar-fill" style="width:${pct}%"></div></div>
    <div style="text-align:right;font-size:11px;color:var(--text-dd);font-family:var(--mono)">${xp}/${nxp} XP</div>

    <div class="p-section">
      <div class="p-section-t">–ù–ê–í–´–ö–ò</div>
      <div class="skill-grid">
        ${Object.values(sk).map(s=>`
          <div class="skill-card ${s.level>0?'on':''}">
            <div class="ic">${s.ic}</div><div class="nm">${s.nm}</div>
            <div class="lv">${s.level}</div>
            <div class="p-bar"><div class="p-bar-fill" style="width:${s.pct}%"></div></div>
          </div>
        `).join('')}
      </div>
    </div>

    <div class="p-section">
      <div class="p-section-t">–ö–û–†–ê–ë–õ–¨</div>
      <div class="p-row"><span class="lbl">–ú–æ–¥–µ–ª—å</span><span class="val">${s.ships[s.currentShip]?.name||'‚Äî'}</span></div>
      <div class="p-row"><span class="lbl">–¢–æ–ø–ª–∏–≤–æ</span><span class="val">${s.fuel.toFixed(1)} / ${s.maxFuel}</span></div>
      <div class="p-bar"><div class="p-bar-fill" style="width:${(s.fuel/s.maxFuel*100).toFixed(0)}%;background:linear-gradient(90deg,var(--red),var(--c1),var(--grn))"></div></div>
      <div class="p-row"><span class="lbl">–ì—Ä—É–∑</span><span class="val">${cw} / ${s.maxCargo} —Ç</span></div>
      <div class="p-bar"><div class="p-bar-fill" style="width:${(cw/s.maxCargo*100).toFixed(0)}%"></div></div>
    </div>

    <div class="p-section">
      <div class="p-section-t">–°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
      <div class="p-row"><span class="lbl">–ö—Ä–µ–¥–∏—Ç—ã</span><span class="val">${s.credits.toLocaleString('ru-RU')} CR</span></div>
      <div class="p-row"><span class="lbl">–ü—Ä—ã–∂–∫–æ–≤</span><span class="val">${s.stats.jumps}</span></div>
      <div class="p-row"><span class="lbl">–î–∏—Å—Ç–∞–Ω—Ü–∏—è</span><span class="val">${s.stats.distanceLY.toFixed(1)} —Å–≤.–ª–µ—Ç</span></div>
      <div class="p-row"><span class="lbl">–¢–æ—Ä–≥–æ–≤—ã—Ö —Å–¥–µ–ª–æ–∫</span><span class="val">${s.stats.trades}</span></div>
      <div class="p-row"><span class="lbl">–î–æ–±—ã—Ç–æ —Ä—É–¥—ã</span><span class="val">${s.stats.mined}</span></div>
      <div class="p-row"><span class="lbl">–ü–ª–∞–Ω–µ—Ç –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ</span><span class="val">${s.stats.planetsScanned}</span></div>
      <div class="p-row"><span class="lbl">–û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å</span><span class="val">${s.stats.totalProfit.toLocaleString('ru-RU')} CR</span></div>
    </div>

    <div class="p-section">
      <div class="p-section-t">–†–ï–ü–£–¢–ê–¶–ò–Ø</div>
      ${Object.entries(s.reputation).map(([k,v])=>{
        const nm={traders:'–¢–æ—Ä–≥–æ–≤—Ü—ã',miners:'–®–∞—Ö—Ç—ë—Ä—ã',explorers:'–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏',military:'–í–æ–µ–Ω–Ω—ã–µ'};
        return`<div class="p-row"><span class="lbl">${nm[k]||k}</span><span class="val">${v}</span></div>
        <div class="p-bar"><div class="p-bar-fill" style="width:${Math.min(100,Math.max(0,v))}%"></div></div>`;
      }).join('')}
    </div>

    <div class="p-section">
      <div class="p-section-t">–ì–†–£–ó</div>
      ${s.cargo.length===0?'<div style="color:var(--text-dd);text-align:center;padding:8px">–¢—Ä—é–º –ø—É—Å—Ç</div>':
        s.cargo.map(c=>`<div class="p-row"><span class="lbl">${c.name}</span><span class="val">${c.qty||1} —Ç</span></div>`).join('')}
    </div>
  `;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  NASA (–∫–µ—à –Ω–∞ –¥–µ–Ω—å + fallback)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const NASA_KEY='DEMO_KEY';
const APOD_FB=[
 {title:'–°—Ç–æ–ª–ø—ã –¢–≤–æ—Ä–µ–Ω–∏—è',explanation:'–û–¥–Ω–æ –∏–∑ —Å–∞–º—ã—Ö –∑–Ω–∞–∫–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–µ–ª–µ—Å–∫–æ–ø–∞ –•–∞–±–±–ª: –°—Ç–æ–ª–ø—ã –¢–≤–æ—Ä–µ–Ω–∏—è –≤ —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–∏ –û—Ä–ª–∞ (M16), 6500 —Å–≤–µ—Ç–æ–≤—ã—Ö –ª–µ—Ç. –ö–æ–ª–æ–Ω–Ω—ã –º–µ–∂–∑–≤—ë–∑–¥–Ω–æ–≥–æ –≥–∞–∑–∞, –≥–¥–µ —Ä–æ–∂–¥–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ –∑–≤—ë–∑–¥—ã.',url:'https://apod.nasa.gov/apod/image/2401/EagleNebula_Hubble_960.jpg',media_type:'image',date:'Hubble Heritage'},
 {title:'–ë–ª–µ–¥–Ω–∞—è –≥–æ–ª—É–±–∞—è —Ç–æ—á–∫–∞',explanation:'–í–æ—è–¥–∂–µ—Ä-1 –æ–±–µ—Ä–Ω—É–ª—Å—è –Ω–∞–∑–∞–¥ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è 6 –º–ª—Ä–¥ –∫–º. –ù–∞—à–∞ –ø–ª–∞–Ω–µ—Ç–∞ ‚Äî –∫—Ä–æ—à–µ—á–Ω—ã–π –ø–∏–∫—Å–µ–ª—å –≤ –ª—É—á–µ —Å–≤–µ—Ç–∞. –ö–∞—Ä–ª –°–∞–≥–∞–Ω: ¬´–í–∑–≥–ª—è–Ω–∏—Ç–µ –µ—â—ë —Ä–∞–∑ –Ω–∞ —ç—Ç—É —Ç–æ—á–∫—É. –≠—Ç–æ –∑–¥–µ—Å—å. –≠—Ç–æ –¥–æ–º. –≠—Ç–æ –º—ã.¬ª',url:'https://apod.nasa.gov/apod/image/2002/PaleBlueDotRevisited_Voyager1_960.jpg',media_type:'image',date:'Voyager 1, 1990'},
 {title:'–ì–∞–ª–∞–∫—Ç–∏–∫–∞ –ê–Ω–¥—Ä–æ–º–µ–¥—ã',explanation:'M31 ‚Äî –±–ª–∏–∂–∞–π—à–∞—è –∫—Ä—É–ø–Ω–∞—è –≥–∞–ª–∞–∫—Ç–∏–∫–∞, 2.5 –º–ª–Ω —Å–≤–µ—Ç–æ–≤—ã—Ö –ª–µ—Ç. –°–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç—Ä–∏–ª–ª–∏–æ–Ω –∑–≤—ë–∑–¥. –ü—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è –∫ –ú–ª–µ—á–Ω–æ–º—É –ü—É—Ç–∏ —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é 110 –∫–º/—Å.',url:'https://apod.nasa.gov/apod/image/2309/M31_HubbleSubaru_960.jpg',media_type:'image',date:'Hubble/Subaru'},
];
const NEO_FB=[
 {name:'–ê–ø–æ—Ñ–∏—Å (99942)',size:370,speed:31,miss:31000,danger:true},
 {name:'–ë–µ–Ω–Ω—É (101955)',size:490,speed:28,miss:7500000,danger:true},
 {name:'–¢—É—Ç–∞—Ç–∏—Å (4179)',size:4500,speed:35,miss:7000000,danger:false},
 {name:'–§–∞—ç—Ç–æ–Ω (3200)',size:5100,speed:36,miss:12000000,danger:false},
];

function nck(){return'nasa6_'+new Date().toISOString().slice(0,10);}

(async function loadNASA(){
  const ck=nck();
  let apod=null;
  try{const c=localStorage.getItem(ck+'_a');if(c)apod=JSON.parse(c);}catch(e){}
  if(!apod){
    try{const r=await fetch('https://api.nasa.gov/planetary/apod?api_key='+NASA_KEY);
      if(r.ok){apod=await r.json();try{localStorage.setItem(ck+'_a',JSON.stringify(apod));}catch(e){}}
    }catch(e){}
  }
  if(!apod)apod=APOD_FB[Math.floor(Math.random()*APOD_FB.length)];
  const card=document.getElementById('apod-card');
  const img=document.getElementById('apod-img');
  if(apod.media_type==='video'){
    const ifr=document.createElement('iframe');ifr.src=apod.url;ifr.allow='autoplay';
    img.replaceWith(ifr);
  }else{
    img.src=apod.hdurl||apod.url;
    img.onerror=function(){this.src='https://apod.nasa.gov/apod/image/2401/EagleNebula_Hubble_960.jpg';};
  }
  document.getElementById('apod-title').textContent=apod.title||'';
  document.getElementById('apod-desc').textContent=(apod.explanation||'').slice(0,250)+'...';
  card.style.display='';

  let neos=null;
  try{const c=localStorage.getItem(ck+'_n');if(c)neos=JSON.parse(c);}catch(e){}
  if(!neos){
    try{const today=new Date().toISOString().slice(0,10);
      const r=await fetch('https://api.nasa.gov/neo/rest/v1/feed?start_date='+today+'&api_key='+NASA_KEY);
      if(r.ok){const d=await r.json();neos=(Object.values(d.near_earth_objects||{}).flat()||[]).slice(0,8);
        try{localStorage.setItem(ck+'_n',JSON.stringify(neos));}catch(e){}}
    }catch(e){}
  }
  const list=document.getElementById('neo-list');
  const neoCard=document.getElementById('neo-card');
  if(!neos||!neos.length){
    list.innerHTML=NEO_FB.map(n=>`<div class="neo-chip"><span class="name">${n.name}</span><br><span class="info">‚åÄ ${n.size} –º ¬∑ ${Number(n.miss).toLocaleString()} –∫–º</span>${n.danger?' <span class="danger">‚ö† –û–ü–ê–°–ù–´–ô</span>':''}</div>`).join('');
  }else{
    list.innerHTML=neos.map(n=>{
      const sz=n.estimated_diameter?Math.round((n.estimated_diameter.meters.estimated_diameter_min+n.estimated_diameter.meters.estimated_diameter_max)/2):0;
      const km=n.close_approach_data&&n.close_approach_data[0]?Math.round(parseFloat(n.close_approach_data[0].miss_distance.kilometers)):0;
      const dng=n.is_potentially_hazardous_asteroid;
      return`<div class="neo-chip"><span class="name">${n.name.replace(/[()]/g,'')}</span><br><span class="info">‚åÄ ${sz} –º ¬∑ ${km.toLocaleString()} –∫–º</span>${dng?' <span class="danger">‚ö†</span>':''}</div>`;
    }).join('');
  }
  neoCard.style.display='';
})();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  NEWS TICKER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const NEWS=[
  'üìú 2847 –≥–æ–¥. –ß–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–æ 47 –∑–≤—ë–∑–¥–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. 3 –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏–∏ –¥–µ–ª—è—Ç –¢—ë–º–Ω—ã–π –§—Ä–æ–Ω—Ç–∏—Ä.',
  'üî≠ –í–æ –í—Å–µ–ª–µ–Ω–Ω–æ–π ‚âà2 —Ç—Ä–ª–Ω –≥–∞–ª–∞–∫—Ç–∏–∫ (Conselice, 2016). –ù–∞–±–ª—é–¥–∞–µ–º–∞—è –í—Å–µ–ª–µ–Ω–Ω–∞—è: 93 –º–ª—Ä–¥ —Å–≤. –ª–µ—Ç.',
  '‚ö° AXIOM Corp –∑–∞—Ö–≤–∞—Ç–∏–ª–∞ —Å–µ–∫—Ç–æ—Ä Delta-7 ‚Äî –∑–∞–ª–µ–∂–∏ He-3 –æ–±–µ—Å–ø–µ—á–∞—Ç —Ñ–ª–æ—Ç –Ω–∞ 200 –ª–µ—Ç.',
  'üåü –í –ú–ª–µ—á–Ω–æ–º –ü—É—Ç–∏ 100‚Äì400 –º–ª—Ä–¥ –∑–≤—ë–∑–¥. –ë–ª–∏–∂–∞–π—à–∞—è ‚Äî –ü—Ä–æ–∫—Å–∏–º–∞ –¶–µ–Ω—Ç–∞–≤—Ä–∞ (4.24 —Å–≤. –≥–æ–¥–∞).',
  'ü™ê NASA: 5 700+ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö —ç–∫–∑–æ–ø–ª–∞–Ω–µ—Ç. TRAPPIST-1: 7 –ø–ª–∞–Ω–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–º —Å –ó–µ–º–ª—é.',
  'üíé 55 Cancri e ‚Äî ¬´–∞–ª–º–∞–∑–Ω—ã–π –º–∏—Ä¬ª. –ú–∞—Å—Å–∞ 8.6 –º–∞—Å—Å –ó–µ–º–ª–∏, 40 —Å–≤. –ª–µ—Ç –æ—Ç –Ω–∞—Å.',
  '‚òÄÔ∏è –°–æ–ª–Ω—Ü–µ ‚Äî –∂—ë–ª—Ç—ã–π –∫–∞—Ä–ª–∏–∫ G2V, 4.6 –º–ª—Ä–¥ –ª–µ—Ç. –ß–µ—Ä–µ–∑ 5 –º–ª—Ä–¥ –ª–µ—Ç —Å—Ç–∞–Ω–µ—Ç –∫—Ä–∞—Å–Ω—ã–º –≥–∏–≥–∞–Ω—Ç–æ–º.',
  'üßä –ï–≤—Ä–æ–ø–∞ (–Æ–ø–∏—Ç–µ—Ä): –ø–æ–¥–ª—ë–¥–Ω—ã–π –æ–∫–µ–∞–Ω –¥–æ 100 –∫–º. –í–æ–∑–º–æ–∂–Ω–∞ –∂–∏–∑–Ω—å.',
  '‚õèÔ∏è –ê—Å—Ç–µ—Ä–æ–∏–¥ –ü—Å–∏—Ö–µ—è: –º–µ—Ç–∞–ª–ª–æ–≤ –Ω–∞ $10 –∫–≤–∏–Ω—Ç–∏–ª–ª–∏–æ–Ω–æ–≤. –ú–∏—Å—Å–∏—è NASA: 2029.',
  'üìä –ù–µ–π—Ç—Ä–æ–Ω–Ω—ã–µ –∑–≤—ë–∑–¥—ã: –ø–ª–æ—Ç–Ω–æ—Å—Ç—å 10¬π‚Å∑ –∫–≥/–º¬≥. –ß–∞–π–Ω–∞—è –ª–æ–∂–∫–∞ = 6 –º–ª—Ä–¥ —Ç–æ–Ω–Ω.',
  'üöÄ –°–∫–æ—Ä–æ—Å—Ç—å —Å–≤–µ—Ç–∞ ‚Äî 299 792 –∫–º/—Å. –î–æ –ü—Ä–æ–∫—Å–∏–º—ã –¶–µ–Ω—Ç–∞–≤—Ä–∞ —Å–≤–µ—Ç –ª–µ—Ç–∏—Ç 4.24 –≥–æ–¥–∞.',
  'üèóÔ∏è –ú–ö–° –≤–µ—Å–∏—Ç 420 —Ç–æ–Ω–Ω, –≤–º–µ—â–∞–µ—Ç 6 —á–µ–ª–æ–≤–µ–∫. –°—Ç–∞–Ω—Ü–∏—è ¬´–û–ª–∏–º–ø¬ª –≤ –∏–≥—Ä–µ ‚Äî 14 –º–æ–¥—É–ª–µ–π, 3000 –∂–∏—Ç–µ–ª–µ–π.',
];
(function initTicker(){
  const el=document.getElementById('ticker');
  el.textContent=NEWS.join('   ‚óè   ');
  const wrap=el.parentElement;
  let off=wrap?wrap.clientWidth||900:900;
  function tick(){
    const tw=el.scrollWidth||3000,sw=wrap?wrap.clientWidth||900:900;
    off-=1;if(off<-tw)off=sw;
    el.style.transform='translateY(-50%) translateX('+off+'px)';
    requestAnimationFrame(tick);
  }
  tick();
})();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  CROSS-MODULE COMMUNICATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
addEventListener('message',e=>{
  if(!e.data||!e.data.type)return;
  const m=e.data;
  switch(m.type){
    case'credits_change':
      gs.credits+=m.amount;if(m.amount>0)gs.stats.totalProfit+=m.amount;
      updateHUD();saveGS();flashEl('h-cr');break;
    case'fuel_change':
      gs.fuel=Math.max(0,Math.min(gs.maxFuel,gs.fuel+m.amount));
      updateHUD();saveGS();flashEl('h-fuel');break;
    case'cargo_add':
      if(gs.cargo.length<gs.maxCargo){gs.cargo.push({name:m.name,qty:m.qty||1,price:m.price||0});
        updateHUD();saveGS();flashEl('h-cargo');}break;
    case'cargo_sell':
      const i=gs.cargo.findIndex(c=>c.name===m.name);
      if(i>=0){const it=gs.cargo.splice(i,1)[0];gs.credits+=m.price||it.price||0;
        gs.stats.trades++;gs.stats.totalProfit+=m.price||it.price||0;updateHUD();saveGS();}break;
    case'stat_increment':
      if(gs.stats[m.stat]!==undefined){gs.stats[m.stat]+=m.amount||1;saveGS();}break;
    case'ship_upgrade':
      if(m.shipName){gs.ships[gs.currentShip].name=m.shipName;gs.ships[gs.currentShip].level=m.level||1;saveGS();}break;
    case'location_update':
      gs.location.system=m.system||gs.location.system;gs.location.body=m.body||null;
      document.getElementById('status-loc').textContent='–°–µ–∫—Ç–æ—Ä: '+gs.location.system+(m.body?' | '+m.body:'');
      saveGS();break;
    case'get_state':
      frame.contentWindow.postMessage({type:'game_state',state:gs},'*');break;
    case'status_msg':
      const el=document.getElementById('status-msg');el.textContent=m.text;
      el.classList.remove('flash');void el.offsetWidth;el.classList.add('flash');break;
  }
});
frame.addEventListener('load',()=>{
  if(frame.src&&frame.src!=='about:blank'){
    setTimeout(()=>{try{frame.contentWindow.postMessage({type:'game_state',state:gs},'*');}catch(e){}},500);
  }
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  KEYBOARD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
addEventListener('keydown',e=>{
  if(e.key==='Escape'){
    if(prof.classList.contains('open'))prof.classList.remove('open');
    else if(curMod!=='welcome')goTo('welcome');
  }
});
</script>
</body>
</html>